# trafficserver.rb
# https://github.com/Homebrew/homebrew-core/blob/master/Formula/trafficserver.rb
# Converted on 02-01-2019

name='trafficserver'
url=('https://www.apache.org/dyn/closer.cgi?path=trafficserver/trafficserver-7.1.4.tar.bz2')
description='HTTP/1.1 compliant caching proxy server'
version='7.1.4' # Guessed version.
priority='optional'
homepage='https://trafficserver.apache.org/'
depends=('openssl' 'pcre')

###### Install ######
# ENV.cxx11 if build.stable?
# ENV["MACOSX_DEPLOYMENT_TARGET"] = MacOS.version
# args = %W[
# --prefix=#{prefix}
# --mandir=#{man}
# --localstatedir=#{var}
# --sysconfdir=#{etc}/trafficserver
# --with-openssl=#{Formula["openssl"].opt_prefix}
# --with-tcl=#{MacOS.sdk_path}/System/Library/Frameworks/Tcl.framework
# --with-group=admin
# --disable-silent-rules
# --enable-experimental-plugins
# ]
# system "autoreconf", "-fvi" if build.head?
# system "./configure", *args
# inreplace "rc/trafficserver.in", "@pkgsysuser@", "$USER"
# inreplace "lib/perl/Makefile",
# "Makefile.PL INSTALLDIRS=$(INSTALLDIRS)",
# "Makefile.PL INSTALLDIRS=$(INSTALLDIRS) INSTALLSITEMAN3DIR=#{man3}"
# system "make" if build.head?
# system "make", "install"
# (var/"log/trafficserver").mkpath
# (var/"trafficserver").mkpath
# config = etc/"trafficserver/records.config"
# return unless File.exist?(config)
# return if File.read(config).include?("proxy.config.admin.user_id STRING #{ENV["USER"]}")
# config.append_lines "CONFIG proxy.config.admin.user_id STRING #{ENV["USER"]}"
